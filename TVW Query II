Using below query, I need to create two columns with this column [P:Misc Install notes].
1. One column is going to call: Month (According with For)
  Could be October, November and December. 
2. Second column is going to call: Ground/Tower. 
If [P:Misc Install notes]contains ‚ÄúNE 1st 18 Sites Tower Cx‚Äù,‚ÄúNE 1st 28 Sites (Ground)‚Äù,‚ÄúNE 2nd 25 Sites (Ground)",‚ÄúNE 3rd (Ground)‚Äù The column Month will be October, and if 
[P:Misc Install notes] contains "Ground", Ground/Tower will be Ground if contain Tower, will be tower. 
For November these are the conditions: "NE Nov Tower‚Äù and ‚ÄúNE Nov Ground‚Äù
For Decembere these are the conditions: "NE Dec Tower‚Äù and ‚ÄúNE Dec Ground‚Äù
The column going to be something like:
Month 	Ground/Tower
October	Ground
November	Tower
December	Ground

Please dont do any change for the rest of the columns. 

WITH PhaseData AS (
SELECT
DATENAME(MONTH, v.[V:(F 3340) Tower Construction Start-Finish]) + ' ' +
CONVERT(varchar(4), YEAR(v.[V:(F 3340) Tower Construction Start-Finish])) AS [Forecast Construction Month],
YEAR(v.[V:(F 3340) Tower Construction Start-Finish]) AS [Year],
MONTH(v.[V:(F 3340) Tower Construction Start-Finish]) AS [Month],
qb.[P:Viaero Root ID],
qb.[P:Viaero In SEA Scope],
v2.[P:Misc Install notes],
qb.[C:Site Name (SPMS)],
v2.[V:(A 2870) ACD Submitted to Customer-Finish],
v2.[V:(A 2885) Velleros Submitted-Finish],
v2.[V:(A 2890) Velleros Datafill Completed-Finish],
v2.[V:(A 4400) TVW Submitted to Customer-Finish],
v2.[V:(A 4405) TVW Approved by Customer-Finish],
CONVERT(varchar(4), YEAR(v.[V:(F 3340) Tower Construction Start-Finish])) + RIGHT('00' + CONVERT(varchar(2), MONTH(v.[V:(F 3340) Tower Construction Start-Finish])), 2) AS [SortOrder]
FROM
[ViaeroDWH].[dbo].[OV_Quickbase] qb
INNER JOIN
[ViaeroDWH].[dbo].[OV_Project_v2] v2 ON qb.[P:Viaero Root ID] = v2.[P:Viaero Root ID]
INNER JOIN
[ViaeroDWH].[dbo].[OV_Project] v ON qb.[P:Viaero Root ID] = v.[P:Viaero Root ID]
WHERE
qb.[P:Viaero Phase] <> 'Pending'
AND qb.[P:Viaero In SEA Scope] = 'YES'
AND qb.[C:Site Name (SPMS)] <> 'CO-KARVAL'
AND v2.[WPK:Work Package Description] <> 'Viaero Trial'
AND v.[V:(F 3340) Tower Construction Start-Finish] IS NOT NULL
),
AggregatedTotals AS (
SELECT
[Forecast Construction Month],
COUNT([P:Viaero Root ID]) as [Total Sites],
SUM(CASE WHEN [V:(A 2870) ACD Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [ACD Submitted],
SUM(CASE WHEN [V:(A 2885) Velleros Submitted-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [Velleros Submitted],
SUM(CASE WHEN [V:(A 2890) Velleros Datafill Completed-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [Velleros Datafill Completed],
SUM(CASE WHEN [V:(A 4400) TVW Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [TVW Submitted],
SUM(CASE WHEN [V:(A 4405) TVW Approved by Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [TVW Approved],
[SortOrder]
FROM
PhaseData
GROUP BY
[Forecast Construction Month], [SortOrder]
)
SELECT
[Forecast Construction Month],
[SortOrder],
[Total Sites],
[ACD Submitted],
[Velleros Submitted],
[Velleros Datafill Completed],
[TVW Submitted],
[TVW Approved],
NULL AS [P:Viaero Root ID],
NULL AS [P:Viaero In SEA Scope],
NULL AS [P:Misc Install notes],
NULL AS [C:Site Name (SPMS)],
NULL AS [V:(A 2870) ACD Submitted to Customer-Finish],
NULL AS [V:(A 2885) Velleros Submitted-Finish],
NULL AS [V:(A 2890) Velleros Datafill Completed-Finish],
NULL AS [V:(A 4400) TVW Submitted to Customer-Finish],
NULL AS [V:(A 4405) TVW Approved by Customer-Finish]
FROM
AggregatedTotals
UNION ALL
SELECT
'Total' AS [Forecast Construction Month],
'999999' AS [SortOrder],
SUM([Total Sites]),
SUM([ACD Submitted]),
SUM([Velleros Submitted]),
SUM([Velleros Datafill Completed]),
SUM([TVW Submitted]),
SUM([TVW Approved]),
NULL AS [P:Viaero Root ID],
NULL AS [P:Viaero In SEA Scope],
NULL AS [P:Misc Install notes],
NULL AS [C:Site Name (SPMS)],
NULL AS [V:(A 2870) ACD Submitted to Customer-Finish],
NULL AS [V:(A 2885) Velleros Submitted-Finish],
NULL AS [V:(A 2890) Velleros Datafill Completed-Finish],
NULL AS [V:(A 4400) TVW Submitted to Customer-Finish],
NULL AS [V:(A 4405) TVW Approved by Customer-Finish]
FROM
AggregatedTotals
UNION ALL
SELECT
[Forecast Construction Month],
[SortOrder],
1 AS [Total Sites],
CASE WHEN [V:(A 2870) ACD Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [ACD Submitted],
CASE WHEN [V:(A 2885) Velleros Submitted-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [Velleros Submitted],
CASE WHEN [V:(A 2890) Velleros Datafill Completed-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [Velleros Datafill Completed],
CASE WHEN [V:(A 4400) TVW Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [TVW Submitted],
CASE WHEN [V:(A 4405) TVW Approved by Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [TVW Approved],
[P:Viaero Root ID],
[P:Viaero In SEA Scope],
[P:Misc Install notes],
[C:Site Name (SPMS)],
[V:(A 2870) ACD Submitted to Customer-Finish],
[V:(A 2885) Velleros Submitted-Finish],
[V:(A 2890) Velleros Datafill Completed-Finish],
[V:(A 4400) TVW Submitted to Customer-Finish],
[V:(A 4405) TVW Approved by Customer-Finish]
FROM
PhaseData

-----V2

WITH PhaseData AS (
SELECT
    DATENAME(MONTH, v.[V:(F 3340) Tower Construction Start-Finish]) + ' ' +
    CONVERT(varchar(4), YEAR(v.[V:(F 3340) Tower Construction Start-Finish])) AS [Forecast Construction Month],
    YEAR(v.[V:(F 3340) Tower Construction Start-Finish]) AS [Year],
    MONTH(v.[V:(F 3340) Tower Construction Start-Finish]) AS [Month],
    qb.[P:Viaero Root ID],
    qb.[P:Viaero In SEA Scope],
    v2.[P:Misc Install notes],
    qb.[C:Site Name (SPMS)],
    v2.[V:(A 2870) ACD Submitted to Customer-Finish],
    v2.[V:(A 2885) Velleros Submitted-Finish],
    v2.[V:(A 2890) Velleros Datafill Completed-Finish],
    v2.[V:(A 4400) TVW Submitted to Customer-Finish],
    v2.[V:(A 4405) TVW Approved by Customer-Finish],
    CONVERT(varchar(4), YEAR(v.[V:(F 3340) Tower Construction Start-Finish])) + RIGHT('00' + CONVERT(varchar(2), MONTH(v.[V:(F 3340) Tower Construction Start-Finish])), 2) AS [SortOrder],

    -- üõ†Ô∏è NEW COLUMN 1: Month (based on [P:Misc Install notes])
    CASE 
        -- October Conditions
        WHEN v2.[P:Misc Install notes] IN (
            'NE 1st 18 Sites Tower Cx',
            'NE 1st 28 Sites (Ground)',
            'NE 2nd 25 Sites (Ground)',
            'NE 3rd (Ground)'
        ) THEN 'October'
        -- November Conditions
        WHEN v2.[P:Misc Install notes] IN (
            'NE Nov Tower',
            'NE Nov Ground'
        ) THEN 'November'
        -- December Conditions
        WHEN v2.[P:Misc Install notes] IN (
            'NE Dec Tower',
            'NE Dec Ground'
        ) THEN 'December'
        ELSE NULL -- Default for sites not matching the specific criteria
    END AS [Month_Phase],

    -- üõ†Ô∏è NEW COLUMN 2: Ground/Tower (based on [P:Misc Install notes] and Month determination)
    CASE
        -- Check conditions for October
        WHEN v2.[P:Misc Install notes] IN (
            'NE 1st 18 Sites Tower Cx',
            'NE 1st 28 Sites (Ground)',
            'NE 2nd 25 Sites (Ground)',
            'NE 3rd (Ground)'
        ) 
        THEN 
            CASE
                WHEN v2.[P:Misc Install notes] LIKE '%Tower%' THEN 'Tower'
                WHEN v2.[P:Misc Install notes] LIKE '%Ground%' THEN 'Ground'
                ELSE NULL -- For the specific October conditions, check if the string contains "Tower" or "Ground"
            END
        
        -- Check conditions for November
        WHEN v2.[P:Misc Install notes] IN (
            'NE Nov Tower',
            'NE Nov Ground'
        ) 
        THEN 
            CASE
                WHEN v2.[P:Misc Install notes] LIKE '%Tower%' THEN 'Tower'
                WHEN v2.[P:Misc Install notes] LIKE '%Ground%' THEN 'Ground'
                ELSE NULL
            END

        -- Check conditions for December
        WHEN v2.[P:Misc Install notes] IN (
            'NE Dec Tower',
            'NE Dec Ground'
        ) 
        THEN 
            CASE
                WHEN v2.[P:Misc Install notes] LIKE '%Tower%' THEN 'Tower'
                WHEN v2.[P:Misc Install notes] LIKE '%Ground%' THEN 'Ground'
                ELSE NULL
            END
        
        ELSE NULL
    END AS [Ground/Tower]

FROM
    [ViaeroDWH].[dbo].[OV_Quickbase] qb
INNER JOIN
    [ViaeroDWH].[dbo].[OV_Project_v2] v2 ON qb.[P:Viaero Root ID] = v2.[P:Viaero Root ID]
INNER JOIN
    [ViaeroDWH].[dbo].[OV_Project] v ON qb.[P:Viaero Root ID] = v.[P:Viaero Root ID]
WHERE
    qb.[P:Viaero Phase] <> 'Pending'
    AND qb.[P:Viaero In SEA Scope] = 'YES'
    AND qb.[C:Site Name (SPMS)] <> 'CO-KARVAL'
    AND v2.[WPK:Work Package Description] <> 'Viaero Trial'
    AND v.[V:(F 3340) Tower Construction Start-Finish] IS NOT NULL
),
AggregatedTotals AS (
SELECT
    [Forecast Construction Month],
    COUNT([P:Viaero Root ID]) as [Total Sites],
    SUM(CASE WHEN [V:(A 2870) ACD Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [ACD Submitted],
    SUM(CASE WHEN [V:(A 2885) Velleros Submitted-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [Velleros Submitted],
    SUM(CASE WHEN [V:(A 2890) Velleros Datafill Completed-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [Velleros Datafill Completed],
    SUM(CASE WHEN [V:(A 4400) TVW Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [TVW Submitted],
    SUM(CASE WHEN [V:(A 4405) TVW Approved by Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END) as [TVW Approved],
    [SortOrder]
FROM
    PhaseData
GROUP BY
    [Forecast Construction Month], [SortOrder]
)
SELECT
    [Forecast Construction Month],
    [SortOrder],
    [Total Sites],
    [ACD Submitted],
    [Velleros Submitted],
    [Velleros Datafill Completed],
    [TVW Submitted],
    [TVW Approved],
    NULL AS [P:Viaero Root ID],
    NULL AS [P:Viaero In SEA Scope],
    NULL AS [P:Misc Install notes],
    NULL AS [C:Site Name (SPMS)],
    NULL AS [V:(A 2870) ACD Submitted to Customer-Finish],
    NULL AS [V:(A 2885) Velleros Submitted-Finish],
    NULL AS [V:(A 2890) Velleros Datafill Completed-Finish],
    NULL AS [V:(A 4400) TVW Submitted to Customer-Finish],
    NULL AS [V:(A 4405) TVW Approved by Customer-Finish],
    NULL AS [Month_Phase],           -- üõ†Ô∏è Added to match column count
    NULL AS [Ground/Tower]          -- üõ†Ô∏è Added to match column count
FROM
    AggregatedTotals
UNION ALL
SELECT
    'Total' AS [Forecast Construction Month],
    '999999' AS [SortOrder],
    SUM([Total Sites]),
    SUM([ACD Submitted]),
    SUM([Velleros Submitted]),
    SUM([Velleros Datafill Completed]),
    SUM([TVW Submitted]),
    SUM([TVW Approved]),
    NULL AS [P:Viaero Root ID],
    NULL AS [P:Viaero In SEA Scope],
    NULL AS [P:Misc Install notes],
    NULL AS [C:Site Name (SPMS)],
    NULL AS [V:(A 2870) ACD Submitted to Customer-Finish],
    NULL AS [V:(A 2885) Velleros Submitted-Finish],
    NULL AS [V:(A 2890) Velleros Datafill Completed-Finish],
    NULL AS [V:(A 4400) TVW Submitted to Customer-Finish],
    NULL AS [V:(A 4405) TVW Approved by Customer-Finish],
    NULL AS [Month_Phase],           -- üõ†Ô∏è Added to match column count
    NULL AS [Ground/Tower]          -- üõ†Ô∏è Added to match column count
FROM
    AggregatedTotals
UNION ALL
SELECT
    [Forecast Construction Month],
    [SortOrder],
    1 AS [Total Sites],
    CASE WHEN [V:(A 2870) ACD Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [ACD Submitted],
    CASE WHEN [V:(A 2885) Velleros Submitted-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [Velleros Submitted],
    CASE WHEN [V:(A 2890) Velleros Datafill Completed-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [Velleros Datafill Completed],
    CASE WHEN [V:(A 4400) TVW Submitted to Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [TVW Submitted],
    CASE WHEN [V:(A 4405) TVW Approved by Customer-Finish] IS NOT NULL THEN 1 ELSE 0 END AS [TVW Approved],
    [P:Viaero Root ID],
    [P:Viaero In SEA Scope],
    [P:Misc Install notes],
    [C:Site Name (SPMS)],
    [V:(A 2870) ACD Submitted to Customer-Finish],
    [V:(A 2885) Velleros Submitted-Finish],
    [V:(A 2890) Velleros Datafill Completed-Finish],
    [V:(A 4400) TVW Submitted to Customer-Finish],
    [V:(A 4405) TVW Approved by Customer-Finish],
    [Month_Phase],                  -- üõ†Ô∏è New column from PhaseData
    [Ground/Tower]                  -- üõ†Ô∏è New column from PhaseData
FROM
    PhaseData
