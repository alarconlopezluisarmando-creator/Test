def read_excel_file(path, file_pattern):

    files = glob.glob(os.path.join(path, file_pattern))

    if not files:
        raise FileNotFoundError(f"No files found matching pattern '{file_pattern}' in directory '{path}'")

    most_recent_file = max(files, key=os.path.getmtime)

    excel_file = pd.read_excel(most_recent_file, header=None)

    # Find the row that starts with 'Project ID'
    header_row = excel_file[excel_file.eq('Project ID').any(axis=1)].index[0]

    # Create the DataFrame, skipping the rows before the header row
    df = excel_file.iloc[header_row:].reset_index(drop=True)

    # Set the first row as the header
    df.columns = df.iloc[0]
    df = df.iloc[1:].reset_index(drop=True)

    # Drop any columns that are entirely empty
    df = df.loc[:, df.notnull().any(axis=0)]

    # Also drop columns that have empty strings or whitespace strings
    df = df.loc[:, ~(df.applymap(lambda x: str(x).strip()).eq('')).all()]

    # Reset the index
    df = df.reset_index(drop=True)

    return df

# Example usage
path = '/var/data/Support_Data/quickbase/Telamon'
file_pattern = '44020 Daily OV Update*.xlsx'

try:
    df = read_excel_file(path, file_pattern)
    print(df.head())
except FileNotFoundError as e:
    print(e)
