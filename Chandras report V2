Starting memory-efficient fetch and processing, saving to C:\Users\l5.lopez\Downloads\00_to delete\raw_data.csv...
Processing database query in chunks of 50000 rows.

FATAL ERROR during chunk processing: (pyodbc.ProgrammingError) ('42000', '[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Error converting data type varchar to float. (8114) (SQLExecDirectW)')
[SQL: 
SELECT
    M.[market_id],
    M.[NE_ID],
    M.[NE_PREFIX],
    M.[ne_type],
    M.[EMS NAME],
    M.[NE NAME],
    M.[NE SOFTWARE],
    M.[region],
    M.[eNB_ID],
    
    -- Columns from OVData table
    OV.[P:Related ENB IDs],
    OV.[P:Project Site Type],
    
    -- Custom LTE calculation (remains with CONCAT for safety)
    CONCAT(CAST(M.market_id AS NVARCHAR(10)), 
           RIGHT(CAST(M.NE_ID AS NVARCHAR(10)), 3)) AS "Custom LTE"
    
FROM [RANCOMM].[dbo].[daily_sites_mapping] M
LEFT JOIN [RANCOMM].[dbo].[OVData] OV
    ON M.[eNB_ID] = OV.[P:Related ENB IDs] 

WHERE 
    M.ne_type IN ('macro_indoor_dist', 'udu_cnf', 'nsb_type')
]
(Background on this error at: https://sqlalche.me/e/20/f405)
