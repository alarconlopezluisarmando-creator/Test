hI, 

I need for the column [RFDS Approval History], the date that are comming inside, and the status, these cand be Approved, Rejected, Pending Review,
for each day I need a count with out duplicates for each of project ID, is one of the is empty, I need you put 0.

Dates need to be the columns and the status the rows. 

SELECT TOP (1000) [Site - Project Name]
      ,[Network Site Name (complete)]
      ,[Site #]
      ,[CBRS (3.65) Site]
      ,[Conditional Tower Top]
      ,[RFDS]
      ,[Vendor Notes]
      ,[RFDS Approval History]
      ,[RFDS Redline Notes]
      ,[RFDS Rejection Notes]
      ,[RFDS Review Status Text]
      ,[Approval Date]
      ,[Date_Refreshed]
      ,[Date Added]
  FROM [ViaeroDWH].[dbo].[QB_RFDS_3days]


DECLARE @cols AS NVARCHAR(MAX),
        @query AS NVARCHAR(MAX);

-- Generate the comma-separated list of the last 7 dates for the PIVOT columns
-- and for the ISNULL check in the final SELECT statement.
SELECT @cols = STRING_AGG(QUOTENAME(CAST(DATEADD(day, -number, GETDATE()) AS DATE)), ',')
FROM (
    SELECT TOP 7 number
    FROM master.dbo.spt_values
    WHERE type = 'P'
    ORDER BY number
) AS T;

-- Construct the full dynamic SQL query
SET @query = '
WITH CTE_DailyCounts AS (
    SELECT
        CAST(JSON_VALUE([RFDS Approval History], ''$.date'') AS DATE) AS [Approval Date],
        JSON_VALUE([RFDS Approval History], ''$.status'') AS [Status],
        COUNT(DISTINCT [Site - Project Name]) AS DailyProjects
    FROM
        [ViaeroDWH].[dbo].[QB_RFDS_3days]
    WHERE
        CAST(JSON_VALUE([RFDS Approval History], ''$.date'') AS DATE) >= CONVERT(DATE, GETDATE() - 6)
        AND JSON_VALUE([RFDS Approval History], ''$.status'') IN (''Approved'', ''Rejected'', ''Pending Review'')
    GROUP BY
        CAST(JSON_VALUE([RFDS Approval History], ''$.date'') AS DATE),
        JSON_VALUE([RFDS Approval History], ''$.status'')
)
SELECT
    Status, ' + REPLACE(@cols, '[', 'ISNULL([') + ', 0) AS ' + REPLACE(@cols, ', ', ', 0) AS ') + '
FROM
    CTE_DailyCounts
PIVOT (
    SUM(DailyProjects)
    FOR [Approval Date] IN (' + @cols + ')
) AS PivotTable;';

-- Execute the dynamic SQL query
EXECUTE sp_executesql @query;
