    # 2. Process Quote Tracker
    REQUIRED_ROOT_ID_COL = 'QT:Root Cell ID'
    TARGET_SITE_COL = 'Site #'
    
    if REQUIRED_ROOT_ID_COL in df_tracker.columns:
        # Use a dictionary to create the new column from the old one, which is safer than rename(inplace=True)
        df_tracker[TARGET_SITE_COL] = df_tracker[REQUIRED_ROOT_ID_COL]
        
        # Now process the new 'Site #' column
        df_tracker[TARGET_SITE_COL] = df_tracker[TARGET_SITE_COL].astype(str).str.strip().str.upper().str.zfill(4)
        
        # Optional: Drop the original column if you don't need it anymore
        df_tracker.drop(columns=[REQUIRED_ROOT_ID_COL], errors='ignore', inplace=True)
    else:
        print(f"Error: The required '{REQUIRED_ROOT_ID_COL}' was not found in the Tracker file.")
        return
    
    # --- The processing for QT:Quote ID should now work ---
    if 'QT:Quote ID' in df_tracker.columns:
        # Using a safer two-step assignment as suggested before
        extracted_ids = df_tracker['QT:Quote ID'].astype(str).str.extract(QUOTE_ID_PATTERN).fillna('')
        df_tracker['QT:Quote ID'] = extracted_ids
    else:
        print("Error: The required 'QT:Quote ID' column was not found in the Tracker file (after processing).")
        return
